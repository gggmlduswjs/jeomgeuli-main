# 작업지시: 점글이(시각장애인 정보접근 PWA) — 풀스택 스캐폴드 & 1차 기능 구현

## 목표
- React PWA(프론트) + Django(백엔드) + Gemini API 연동으로,
  - **정보탐색 모듈**(뉴스 요약/쉬운 설명/Q&A, 카드/불릿 UI, 핵심 키워드 추출, TTS/STT, 점자 출력 토글)
  - **점자 학습 모듈**(자모/글자/단어/문장/자유 변환, 자동 테스트/복습 노트)
  를 **동작 가능한 수준**으로 구현한다.
- 초판에서 하드웨어(BLE) 제어는 **스텁**으로 두고, API·UI·흐름을 우선 완성한다.
- **Figma Dev 모드 값**(spacing/폰트/컬러)을 반영한 레이아웃을 재현한다(가급적 Tailwind 토큰화).

## 기술 선택
- Frontend: **Vite + React + TypeScript + Tailwind** (PWA 지원, Web Speech API(STT/TTS))
- State: React Query(데이터), Zustand(간단 전역), React Router
- Backend: **Django 4 + DRF + django-cors-headers** (+ Channels는 2차)
- AI: **Google Gemini(1.5-flash 또는 1.5-pro)** (서버에서 호출)
- 공통: .env로 비밀키 관리(GEMINI_API_KEY 등), Windows 개발환경 우선

## 디렉터리
.
├─ frontend/
│ ├─ src/
│ │ ├─ app/App.tsx
│ │ ├─ app/routes.tsx
│ │ ├─ components/ (HeaderBar, MicButton, QuickActions, KeywordChips, BrailleToggle, TTSButton, Card, BulletList 등)
│ │ ├─ pages/
│ │ │ ├─ Home.tsx # [점자학습] [정보탐색] 큰 버튼
│ │ │ ├─ Explore.tsx # 정보탐색 탭(우:챗좌:카드/불릿)
│ │ │ ├─ Learn.tsx # 학습 탭(자모/단어/문장/자유 변환)
│ │ │ └─ Review.tsx # 복습 노트
│ │ ├─ hooks/ (useSTT.ts, useTTS.ts, useBraille.ts(스텁))
│ │ ├─ services/api.ts
│ │ ├─ store/ (keywords.ts, review.ts)
│ │ └─ styles/tokens.css # Figma 기반 토큰
│ ├─ public/manifest.webmanifest, icons
│ ├─ index.html
│ ├─ vite.config.ts
│ └─ package.json
└─ backend/
├─ manage.py
├─ jeomgeuli_backend/settings.py
├─ requirements.txt
├─ .env.example
└─ apps/
├─ chat/ # /api/chat/ask
├─ learn/ # /api/learn/*
└─ braille/ # /api/braille/output (스텁)

bash
코드 복사

## API 계약(초안)
- `POST /api/chat/ask`
  - req: `{ "query": string }`
  - res: 
    ```json
    {
      "mode": "news|explain|qa",
      "summary": "텍스트 본문",
      "simple": "쉬운 말 버전(초등~중등)",
      "keywords": ["경제","물가","정부"],
      "cards": [ { "title":"...", "oneLine":"...", "url":"..." } ]  // mode=news
    }
    ```
- `GET /api/learn/next?mode=char|word|sent|free`
  - 각 단계별 문제/텍스트/점자토큰 반환
- `POST /api/braille/output`
  - req: `{ "tokens": ["오","늘","띄어쓰기"], "mode":"once|chunked" }`
  - res: `{ "ok": true }` (초판은 서버에서만 ACK, HW는 스텁)

## 백엔드 구현 지시
1) `requirements.txt`
Django==4.2.*
djangorestframework
django-cors-headers
google-generativeai
python-dotenv
httpx

markdown
코드 복사
2) `settings.py`
- `corsheaders` 설치/미들웨어 추가
- `CORS_ALLOW_ALL_ORIGINS = True` (초판 단순화)
3) `.env.example`
GEMINI_API_KEY=AIzaSyBk-T-6cQq5hUz5kh9o1_E2QS-YFnQRo3c

markdown
코드 복사
4) Gemini 클라이언트(서비스 레이어)
- 모델: `models/gemini-1.5-flash` (텍스트용 `generate_content`)
- 에러 메시지에 안내된 **모델/버전 불일치**가 없도록 최신 방식 사용
5) `/api/chat/ask` 뷰
- 사용자 `query` 분석 → `mode` 결정(news/explain/qa)
- `news`인 경우 5카드 형태로 요약(제목/한줄/링크) + `keywords` 2~3개 추출
- `explain`은 3~5 불릿 + 마지막 ‘쉬운 말’ 1줄
- 모든 응답에 `{summary, simple, keywords}` 채움
6) `/api/learn/*`
- 자모/단어/문장/자유 변환용 **샘플 데이터** 제공
- TTS 문구는 첨부된 **TTS 대본(pdf)** 내용을 사용해 구성(파일 텍스트는 현재 단계에 하드코딩 or json seed)
7) `/api/braille/output`
- 현재는 응답만 OK 반환(하드웨어 후속 연동 대비해 로깅)

## 프론트엔드 구현 지시
- **PWA 설정**(manifest, 아이콘)
- **라우팅**
- `/` → Home(큰 버튼 두 개 “점자학습/정보탐색”, 진입 TTS)
- `/explore` → 정보탐색(우:채팅, 좌:카드/불릿 패널, 하단 Quick[다음/반복/학습하기])
- `/learn` → 학습(자모/단어/문장/자유 변환 탭, 자동 테스트/복습)
- `/review` → 복습 노트
- **UI/UX(피그마 반영)**
- 듀얼 패널 레이아웃: `grid-cols-[360px_1fr]` 비슷한 분할
- 카드: 라운드, 소프트 섀도우, 큰 타이포
- 말풍선: 사용자(우측 연두), 챗봇(좌측 회색), 스트리밍 타이핑 애니메
- 상단 **점자 출력 토글** + 키워드 칩(3개 내)
- **상태/서비스**
- `services/api.ts`에 `chat.ask`, `learn.next`, `braille.output`
- `store/keywords.ts`(추출 키워드를 저장 → Review로 전송)
- **음성**
- `useSTT`: Web Speech API, 한국어, 2회 실패 시 텍스트 유도
- `useTTS`: SpeechSynthesis, 재생/정지/속도 제어
- **점자 출력 스텁**
- `useBraille`: 키워드 칩 클릭/음성명령(다음/반복/멈춰/시작)에 맞춰 토큰을 순차표시(실 HW는 후속)
- **접근성**
- 탭/Enter 포커스 이동, aria-label, 큰 폰트/고대비 토글
- **피그마 Dev 값 반영**
- `styles/tokens.css`에 spacing/size/font/color 토큰 정의 후 컴포넌트에서 사용
- **오류 방지**
- 지난 프로젝트의 오류(컴포넌트 미생성, 중복 useState 선언 등)가 재발하지 않게 **컴파일 통과/런타임 에러 0**을 기준으로 만든다.

## 학습/정보탐색 동작 요구(요약)
- 정보탐색:
- “오늘 뉴스 5개 요약해줘” → 좌측 카드 5개 + 우측 챗 응답 + 자동 TTS + 상단 키워드 칩(점자 토글 ON시 순차 출력/제어)
- “블록체인 쉽게 설명해줘” → 3~5 불릿 + 마지막 쉬운 말 1줄 + 키워드 2~3
- “GPT-5가 뭐야?” → 일반 Q&A
- 학습:
- 자모/단어/문장: 안내 TTS(대본 기반), “다음/반복/멈춰”, 자동 테스트(10문항 내), 오답은 Review 저장
- 자유 변환: 입력 문장 → 3글자 단위 분할 출력, 제어 명령 반영

## 수용 기준(AC)
- 프론트 `npm run dev`(3000), 백엔드 `manage.py runserver`(8000)로 **즉시 통신 가능(CORS 통과)**.
- `/explore`에서 3가지 모드(news/explain/qa) **모두 작동**하고, `keywords` 칩 생성/토글에 따라 점자 스텁 순차 출력.
- `/learn`에서 4모드 뼈대 + 자모/단어/문장/자유 변환 최소 2케이스씩 동작. 테스트/복습 저장 흐름 보임.
- 컴파일 에러/런타임 크래시 **없음**. README에 실행법 기재.

## 참고/메모
- TTS 안내 문구는 제공된 **TTS 대본**을 우선 사용(초판은 정적 시드로 OK). 
- STT/TTS 브라우저 권한 안내 필요.
- Gemini 호출 실패 시 친절한 폴백 메시지/로컬 더미 카드 제공.